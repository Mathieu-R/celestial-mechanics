\documentclass[11pt,twoside=semi,openright,numbers=noenddot]{article}

\def\ncode {LPHYS1351}
\def\ncourse {Projet différences finies}
\def\nlecturer {M. Crucifix}
\def\nyear {2021}
\def\ntitle {Mécanique Céleste}

\input{./header}

\begin{document}

\input{./title-page}

\tableofcontents
\newpage

Le but de cet exercice est de simuler l'évolution de l'orbite de Jupiter pour les $5000$ prochaines années. Dans un premier temps nous ne tiendrons compte que de Jupiter et du Soleil (\textbf{problème à 2 corps}) et nous ajouterons par la suite la contribution de Saturne (\textbf{problème à 3 corps}).

\section{Problème à 2 corps}

Soit $m_1$ la masse du Soleil et $m_2$ la masse de Jupiter avec $m_1 \gg m_2$ et $\vec{r}_1$ la position du Soleil et $\vec{r}_2$ la position de Jupiter avec $\vec{r} = |\vec{r}_1 - \vec{r}_2|$ leur distance relative.

Prenons $\vb{q} \equiv \vb{r} = (x, y, z) \in \R^3$ comme coordonnée généralisée.

L'énergie cinétique du système est,
\begin{align*}
  T &= \sum_{i=1}^{2} T_i \\
    &= \frac{1}{2} m_1 \vd{r}_1^2 + \frac{1}{2} m_2 \vd{r}_2^2
\end{align*}

L'énergie potentielle est,
\begin{equation*}
  V = V(|\vec{r}_1 - \vec{r}_2|) = - \frac{Gm_1m_2}{|\vec{r}_1 - \vec{r}_2|}
\end{equation*}
avec $G$ la constante universelle de gravitation.

Le Lagrangien est donc, 
\begin{equation}
  \lag = \frac{1}{2} m_1 \vd{r}_1^2 + \frac{1}{2} m_2 \vd{r}_2^2 + \frac{Gm_1m_2}{|\vec{r}_1 - \vec{r}_2|}
\end{equation}

Lorsqu'on cherche une solution analytique, souvent on réexprime le Lagrangien en terme du mouvement relatif $\vb{r}$ et du mouvement du centre de masse $\vb{r}_{CM}$ et on passe en coordonnées sphériques. Ce n'est pas d'utilité dans notre cas.

L'Hamiltonien est la transformée de Legendre du Lagrangien, 
\begin{align}
  \ham 
    &= \sum_{i=1}^2 \vb{p}_i \cdot \vb{r}_i - \lag \\
    &= \frac{\vb{p}_1^2}{2m_1} + \frac{\vb{p}_2^2}{2m_2} - \frac{Gm_1m_2}{|\vb{r}_1 - \vb{r}_2|}
\end{align}
 où $\vb{p}_i$ est l'impulsion conjuguée de la i-ème masse.

 On trouve finalement les équations canoniques,
\begin{align}
  p_{1,x} &= - \pdv{\ham}{{x}_1} = - Gm_1m_2 \frac{2(x_1 - x_2)}{\left( (x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2 \right)^{3/2}} \\
  \dot{x}_1 &= \pdv{\ham}{p_{1,x}} = \frac{p_{1,x}}{m_1}
\end{align}

etc\dots

\subsection{Schémas numériques}
\subsubsection{Heun (RK2)}
Partons du schéma de Heun, 
\begin{align*}
  \begin{cases}
    \tilde{y}_{j+1} &= y_j + (\Delta t) \vb{f}_j \\
    y_{j+1} &= y_j + \frac{1}{2}(\vb{k}_1 + \vb{k}_2)
  \end{cases}
\end{align*}

Où les coefficients $\vb{k}_1$ et $\vb{k}_2$ sont donnés par, 
\begin{align*}
  \vb{k}_1 &= (\Delta t) \vb{f}_j \\
  \vb{k}_2 &= (\Delta t) \vb{f} (t_{j+1}, \tilde{y}_{j+1})
\end{align*}

Ce qui nous donne,
\begin{align}
  y(t_{j+1}) 
    &= y(t_j) + \frac{1}{2}(\Delta t) \vb{f}(t_j) + \frac{1}{2}(\Delta t) \vb{f}(t_{j+1}, \vb{y_j} + (\Delta t) \vb{f}(t_j)) \\
    &= y(t_j) + \frac{1}{2}(\Delta t) \vb{f}(t_j) + \frac{1}{2}(\Delta t) \vb{f}(t_{j+1}, \tilde{y}(t_{j+1}))
\end{align}

Effectuons un développement de Taylor de $\vb{f}(t_{j+1}, \tilde{y}(t_{j+1}))$,
\begin{align*}
  \vb{f}(t_{j+1}, \tilde{y}_{j+1}) 
    &= \vb{f}(t_j + \Delta t, \tilde{y}(t_j + \Delta t)) \\
    &= \vb{f}(t_j, \tilde{y}(t_j)) + (\Delta t) \pdv{f(t_j, y_j)}{t} + (\Delta y) \pdv{f(t_j, y_j)}{y} + \frac{1}{2} (\Delta t)^2 \pdv[2]{f(t_j, y_j)}{t} \\ 
    &+ \frac{1}{2} (\Delta y)^2 \pdv[2]{f(t_j, y_j)}{y} + \frac{1}{2} (\Delta t) (\Delta y) \pdv{f(t_j, y_j)}{t}{y} + (\Delta y) \pdv{f(t_j, y_j)}{y}
\end{align*}

\begin{definition}
  Un schéma numérique est dit \textbf{consistent} si l'itération converge vers l'expression du système original lorsque $\Delta t \rightarrow 0$
\end{definition}

On cherche à savoir si le schéma de Heun est consistent avec 
\begin{equation}
  \vd{y}(t) \equiv \vb{f}(t, y) 
\end{equation}

Pour cela, on regarde au schéma de Taylor,
\begin{align*}
  y(t_{j+1}) 
    &= y(t_j + \Delta t) \\
    &= y(t_j) + (\Delta t) y^{(1)}(t_j) + \frac{1}{2!}(\Delta t)^2 y^{(2)}(t_j) + \frac{1}{3!} (\Delta t)^3 y^{(3)}(t_j) + \dots \\
    &= y(t_j) + (\Delta t) \vb{f}(t_j, y(t_j)) + \frac{1}{2!}(\Delta t)^2 y^{(2)}(t_j) + \frac{1}{3!} (\Delta t)^3 y^{(3)}(t_j) + \dots
\end{align*}

On effectue la différence du Heun avec le schéma de Taylor et on observe que, 
\begin{equation}
  y_{\text{Heun}} - y_{\text{Taylor}} = \mathcal{O}((\Delta t)^3)
\end{equation}

Par conséquent, l'erreur commise à chaque pas de temps est de l'ordre de $(\Delta t)^3$ puisque cette différence tend vers zéro pour $(\Delta t) \rightarrow 0$, on trouve que la méthode de Heun est convergente à l'ordre $\tau = ((\Delta t)^2)$.

\begin{theorem}
  Soit une équation différentielle $y' = Ay$, où on suppose que la matrice $A \in \R^{n \times n}$ à une base de vecteurs propres et de valeurs propres $\lambda_1, \dots, \lambda_n$, la méthode de Runge Kutta a un point fixe stable (asymptotiquement stable) à l'origin lorsque appliqué à 
  \begin{equation}
    \dv{y}{t} = Ay 
  \end{equation}
  ssi le même schéma numérique à un équilibre stable (asymptotiquement stable) à l'origine lorsque apliqué à l'EDO scalaire, 
  \begin{equation}
    \dv{x}{t} = \lambda x 
  \end{equation}
  où $\lambda$ est une valeur propre de $A$.
\end{theorem}

\begin{corollary}
  Soit une EDO $\dv{y}{t} = Ay$ avec une matrice diagonalisable $A$. Soit une méthode RK donnée avec une fonction de stabilité $R$. L'origine est stable si 
  \begin{equation}
    |R(\lambda \Delta t)| \leq 1
  \end{equation}
\end{corollary}

\begin{definition} [région de stabilité]
  La région de stabilité d'un schéma numérique est la région telle que $R(\Delta t) \leq 1$  
\end{definition}

\begin{definition} [A-stabilité]
  Un schéma numérique est dit \textbf{A-stable} si les $y_N$ restent bornés dans le problème de décroissance radioactive.
\end{definition}

Afin de connaitre la \textbf{A-stabilité}, on compare la méthode de Heun avec l'équation de la décroissance radioactive. Prenons, 
\begin{equation*}
  \dv{y}{t} = - y \equiv f(t, y)
\end{equation*}

On a,
\begin{align*}
  y_{j+1}
    &= y_j - \frac{1}{2}(\Delta t) y_j - \frac{1}{2}(\Delta t) \tilde{y}_{j+1} \\
    &= y_j - \frac{1}{2}(\Delta t) y_j - \frac{1}{2}(\Delta t) (y_j - (\Delta t) y_j) \\
    &= y_j \left( 1 - \frac{1}{2}(\Delta t) - \frac{1}{2}(\Delta t) + \frac{1}{2}(\Delta t)^2 \right) \\
  y_N &= y_0 \left( 1 - \Delta t + \frac{1}{2}(\Delta t)^2 \right)^N
\end{align*}

Pour que $y_N$ soit borné il faut que, 
\begin{align*}
  \left| 1 - \Delta t + \frac{1}{2}(\Delta t)^2 \right| \leq 1 
    &\iff -1 \leq 1 - \Delta t + \frac{1}{2}(\Delta t)^2 \leq 1 \\
    &\iff -2 \leq - \Delta t + \frac{1}{2}(\Delta t)^2 \leq 0
\end{align*}

\subsubsection{RK4}
Partons du schéma de RK4, 
\begin{align*}
  y_{j+1} = y_j + \frac{1}{6}(\vb{k}_1 + 2 \vb{k}_2 + 2 \vb{k}_3 + \vb{k}_4)
\end{align*}

Où les coefficients $\vb{k}_1$, $\vb{k}_2$, $\vb{k}_3$ et $\vb{k}_4$ sont donnés par, 
\begin{align*}
  \vb{k}_1 &= (\Delta t) \vb{f}_j \\
  \vb{k}_2 &= (\Delta t) \vb{f} (t_{j} + \frac{\Delta t}{2}, \vb{y_j} + \frac{1}{2 }\vb{k}_1) \\ 
  \vb{k}_3 &= (\Delta t) \vb{f} (t_{j} + \frac{\Delta t}{2}, y_j + \frac{1}{2} \vb{k}_2) \\ 
  \vb{k}_4 &= (\Delta t) \vb{f} (t_{j}, y_{j} + \vb{k}_3) 
\end{align*}

Effectuons un développement de Taylor du schéma de RK4,
\begin{align*}
  y(t_{j+1}) 
    &= y(t_j + \Delta t) \\
    &= y(t_j) + (\Delta t) y^{(1)}(t_j) + \frac{1}{2!}(\Delta t)^2 y^{(2)}(t_j) + \frac{1}{3!} (\Delta t)^3 y^{(3)}(t_j) + \frac{1}{4!} (\Delta t)^4 y^{(4)}(t_j) + \dots \\
    &= y(t_j) + (\Delta t) \vb{f}(t_j, y(t_j)) + \frac{1}{2!}(\Delta t)^2 y^{(2)}(t_j) + \frac{1}{3!} (\Delta t)^3 y^{(3)}(t_j) + \frac{1}{4!} (\Delta t)^4 y^{(4)}(t_j) + \dots
\end{align*}

Après quelques calculs, on trouve que la différence entre le RK4 et le schéma de Taylor est de l'ordre de $((\Delta t)^5)$ ce qui implique que la méthode de RK4 est convergence à l'ordre $\tau = ((\Delta t)^4)


\end{document}